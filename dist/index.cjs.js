"use strict";var e;Object.defineProperty(exports,"__esModule",{value:!0}),function(e){e.version="1.0.0"}(e||(e={}));const t=e=>{const t=history[e];return function(){const r=t.apply(this,arguments),s=new Event(e);return window.dispatchEvent(s),r}},r=["click","dbclick","contextmenu","mousedown","mouseup","mouseenter","mouseout","mouseover"];const s=e=>{const{origin:t,padding:r,length:s,position:o}=Object.assign({padding:"0",length:2,position:"end"},e);return"start"===o?t.padStart(s,r):t.padEnd(s,r)};exports.Reporter=class{constructor(e){this.data=Object.assign(this.initDef(),e),this.installInnerReporter()}initDef(){return this.version=e.version,window.history.pushstate=t("pushState"),window.history.replaceState=t("replaceState"),{domReporter:!1,historyReporter:!1,hashReporter:!1,jsErroer:!1,repoterVersion:this.version}}setUserId(e){this.data.uuid=e}setExtraData(e){this.data.extraData=e}sendReporter(e){this.report(e)}report(e){const t=Object.assign(this.data,e,{time:Date.now()}),r=new Blob([JSON.stringify(t)],{type:"application/x-www-form-urlencoded"});navigator.sendBeacon(this.data.requestUrl,r)}installInnerReporter(){this.data.historyReporter&&(this.captureEvents(["pushstate"],"history-pv"),this.captureEvents(["replacestate"],"history-pv"),this.captureEvents(["popstate"],"history-pv")),this.data.hashReporter&&this.captureEvents(["hashchange"],"hash-pv"),this.data.domReporter&&this.targetReport(),this.data.jsErroer&&this.jsReport()}captureEvents(e,t,r){e.forEach((e=>{window.addEventListener(e,(()=>{this.report({event:e,targetKey:t,data:r})}))}))}targetReport(){r.forEach((e=>{window.addEventListener(e,(t=>{const r=t.target.getAttribute("target-key");r&&this.sendReporter({targetKey:r,event:e})}))}))}jsReport(){this.captureJsError(),this.capturePromiseReject()}captureJsError(){window.addEventListener("error",(e=>{this.sendReporter({targetKey:"js-error",event:"js",message:e.message})}))}capturePromiseReject(){window.addEventListener("unhandledrejection",(e=>{e.promise.catch((e=>{this.sendReporter({targetKey:"promise-error",event:"promise",message:e})}))}))}},exports.Storage=class{constructor(e){this.storage=window.localStorage,e&&(this.storage=window[e])}get(e){const t=this.storage.getItem(e);try{return t?JSON.parse(t):t}catch(e){return t}}set(e,t){this.storage.setItem(e,JSON.stringify(t))}remove(e){this.storage.removeItem(e)}clear(){this.storage.clear()}},exports.dateFormat=(e,t)=>{if(!e)return e;"string"==typeof e&&(e=e.replace("-","/"));const r=new Date(e);if(isNaN(r.getTime()))return console.error(`${e} is not a valid datelike parameter`),e;const o=r.getFullYear()+"",i=s({origin:r.getMonth()+1+""}),a=s({origin:r.getDate()+""}),n=s({origin:r.getHours()+""}),p=s({origin:r.getMinutes()+""}),c=s({origin:r.getSeconds()+""});return t.replace("YYYY",o).replace("MM",i).replace("DD",a).replace("hh",n).replace("mm",p).replace("ss",c)},exports.debounce=function(e,t=200,r=!1){let s;return function(...o){s&&(clearTimeout(s),s=null),r&&(r=!1,e.apply(this,o)),s=setTimeout((()=>{e.apply(this,o),clearTimeout(s),s=null}),t)}},exports.padString=s,exports.throttle=function(e,t=200,r=!1){let s;return function(...o){s||(r&&(r=!1,e.apply(this,o)),s=setTimeout((()=>{e.apply(this,o),clearTimeout(s),s=null}),t))}};
